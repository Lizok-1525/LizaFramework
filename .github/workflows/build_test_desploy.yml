name: 🚀 FTP Deploy

on:
  push:
    branches:
      - main  # Se ejecuta cuando hay cambios en la rama principal

jobs:
  deploy:
    name: 📂 Subir archivos por FTP
    runs-on: ubuntu-latest

    steps:
    - name: 🛒 Obtener el código del repositorio
      uses: actions/checkout@v3

    - name: 📦 Instalar LFTP
      run: sudo apt update && sudo apt install -y lftp

    - name: 🏗️ Construir el proyecto (opcional)
      run: |
        cd LizaFramework  # O la carpeta donde está package.json
        npm install
        npm run build
      if: success()

    - name: 📂 Verificar archivos generados
      run: ls -la dist/  # Asegúrate de que 'dist/' existe antes de subir

    - name: 📤 Subir archivos al servidor FTP
      run: |
        lftp -e "
        set ftp:ssl-allow no;
        open -u ${{ secrets.FTP_USER }},${{ secrets.FTP_PASSWORD }} ${{ secrets.FTP_HOSTNAME }};
        bye
        "